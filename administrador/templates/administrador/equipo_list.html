{% extends 'administrador/base_list.html' %}
{% load static %}

{% block title %}Equipos | Digit Soft{% endblock %}
{% block page_header %}Equipos{% endblock %}

{% block list_title %}Gestión de Equipos{% endblock %}
{% block list_description %}Administra el registro de equipos de los clientes{% endblock %}

{% block table_headers %}
<th>Código</th>
<th>Nombre</th>
<th>Tipo</th>
<th>Marca</th>
<th>Cliente</th>
<th>Estado Físico</th>
<th>Estado</th>
<th style="width: 200px;">Acciones</th>
{% endblock %}

{% block table_body %}
{% if equipos %}
    {% for equipo in equipos %}
    <tr>
        <td><strong>{{ equipo.codigo_equipo }}</strong></td>
        <td>{{ equipo.nombre }}</td>
        <td>{{ equipo.get_tipo_equipo_display }}</td>
        <td>{{ equipo.marca.nombre }}</td>
        <td>{{ equipo.cliente.nombre_completo }}</td>
        <td>
            {% if equipo.estado_fisico == 'NUEVO' %}
                <span class="badge badge-success">{{ equipo.get_estado_fisico_display }}</span>
            {% elif equipo.estado_fisico == 'BUENO' %}
                <span class="badge badge-info">{{ equipo.get_estado_fisico_display }}</span>
            {% elif equipo.estado_fisico == 'REGULAR' %}
                <span class="badge badge-warning">{{ equipo.get_estado_fisico_display }}</span>
            {% else %}
                <span class="badge badge-danger">{{ equipo.get_estado_fisico_display }}</span>
            {% endif %}
        </td>
        <td>
            {% if equipo.activo %}
                <span class="badge badge-success">Activo</span>
            {% else %}
                <span class="badge badge-danger">Inactivo</span>
            {% endif %}
        </td>
        <td>
            <div class="actions-cell">
                <button class="btn btn-info btn-sm" onclick="viewDetails({{ equipo.id }})" title="Ver detalles">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="btn btn-primary btn-sm" onclick="editRecord({{ equipo.id }})" title="Editar">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-warning btn-sm" onclick="viewHistory({{ equipo.id }}, '{{ equipo.nombre }}')" title="Historial">
                    <i class="fas fa-history"></i>
                </button>
                <button class="btn btn-danger btn-sm" onclick="deleteRecord({{ equipo.id }}, '{{ equipo.nombre }}')" title="Eliminar">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </td>
    </tr>
    {% endfor %}
{% else %}
    <tr>
        <td colspan="8" class="empty-state">
            <i class="fas fa-laptop"></i>
            <p>No hay equipos registrados</p>
            <button class="btn btn-primary" onclick="openModal('createModal')">
                <i class="fas fa-plus"></i> Agregar Primer Equipo
            </button>
        </td>
    </tr>
{% endif %}
{% endblock %}

{% block form_content %}
<div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <div class="form-group">
        <label class="form-label">Código del Equipo *</label>
        <input type="text" name="codigo_equipo" class="form-control" required placeholder="Ej: EQ-001">
    </div>
    <div class="form-group">
        <label class="form-label">Nombre del Equipo *</label>
        <input type="text" name="nombre" class="form-control" required placeholder="Ej: Portátil HP">
    </div>
</div>

<div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <div class="form-group">
        <label class="form-label">Tipo de Equipo *</label>
        <select name="tipo_equipo" class="form-control" required>
            <option value="">Seleccione...</option>
            <option value="DESKTOP">Computador de Escritorio</option>
            <option value="LAPTOP">Computador Portátil</option>
            <option value="SERVER">Servidor</option>
            <option value="PRINTER">Impresora</option>
            <option value="SCANNER">Escáner</option>
            <option value="NETWORK">Equipo de Red</option>
            <option value="MONITOR">Monitor</option>
            <option value="UPS">UPS</option>
            <option value="OTROS">Otros</option>
        </select>
    </div>
    <div class="form-group">
        <label class="form-label">Cliente *</label>
        <select name="cliente" class="form-control" required>
            <option value="">Seleccione un cliente...</option>
            {% for cliente in clientes %}
                <option value="{{ cliente.id }}">{{ cliente.nombre_completo }}</option>
            {% endfor %}
        </select>
    </div>
</div>

<div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <div class="form-group">
        <label class="form-label">Marca *</label>
        <select name="marca" class="form-control" required>
            <option value="">Seleccione una marca...</option>
            {% for marca in marcas %}
                <option value="{{ marca.id }}">{{ marca.nombre }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label class="form-label">Modelo *</label>
        <input type="text" name="modelo" class="form-control" required placeholder="Ej: Pavilion 15">
    </div>
</div>

<div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <div class="form-group">
        <label class="form-label">Número de Serie *</label>
        <input type="text" name="serial" class="form-control" required placeholder="Número de serie único">
    </div>
    <div class="form-group">
        <label class="form-label">Estado Físico *</label>
        <select name="estado_fisico" class="form-control" required>
            <option value="NUEVO">Nuevo</option>
            <option value="BUENO">Bueno</option>
            <option value="REGULAR">Regular</option>
            <option value="MALO">Malo</option>
            <option value="DAÑADO">Dañado</option>
            <option value="EN_REPARACION">En Reparación</option>
        </select>
    </div>
</div>

<div class="form-group">
    <label class="form-label">Especificaciones Técnicas *</label>
    <textarea name="especificaciones" class="form-control" rows="4" required placeholder="Procesador, RAM, Disco duro, etc."></textarea>
</div>
{% endblock %}
