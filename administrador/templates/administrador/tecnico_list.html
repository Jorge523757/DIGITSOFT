{% extends 'administrador/base_list.html' %}
{% load static %}

{% block title %}Técnicos | Digit Soft{% endblock %}
{% block page_header %}Técnicos{% endblock %}

{% block list_title %}Gestión de Técnicos{% endblock %}
{% block list_description %}Administra el personal técnico de la empresa{% endblock %}

{% block table_headers %}
<th>Documento</th>
<th>Técnico</th>
<th>Especialidades</th>
<th>Nivel</th>
<th>Estado</th>
<th>Servicios</th>
<th>Calificación</th>
<th style="width: 200px;">Acciones</th>
{% endblock %}

{% block table_body %}
{% if tecnicos %}
    {% for tecnico in tecnicos %}
    <tr>
        <td><strong>{{ tecnico.numero_documento }}</strong></td>
        <td>{{ tecnico.nombre_completo }}</td>
        <td>{{ tecnico.especialidades|truncatewords:5 }}</td>
        <td>
            <span class="badge badge-info">{{ tecnico.get_nivel_experiencia_display }}</span>
        </td>
        <td>
            {% if tecnico.estado_actual == 'DISPONIBLE' %}
                <span class="badge badge-success">{{ tecnico.get_estado_actual_display }}</span>
            {% elif tecnico.estado_actual == 'OCUPADO' %}
                <span class="badge badge-warning">{{ tecnico.get_estado_actual_display }}</span>
            {% else %}
                <span class="badge badge-danger">{{ tecnico.get_estado_actual_display }}</span>
            {% endif %}
        </td>
        <td>{{ tecnico.servicios_completados }}</td>
        <td>⭐ {{ tecnico.calificacion_promedio|floatformat:1 }}</td>
        <td>
            <div class="actions-cell">
                <button class="btn btn-info btn-sm" onclick="viewDetails({{ tecnico.id }})" title="Ver detalles">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="btn btn-primary btn-sm" onclick="editRecord({{ tecnico.id }})" title="Editar">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-warning btn-sm" onclick="viewHistory({{ tecnico.id }}, '{{ tecnico.nombre_completo }}')" title="Historial">
                    <i class="fas fa-history"></i>
                </button>
                <button class="btn btn-danger btn-sm" onclick="deleteRecord({{ tecnico.id }}, '{{ tecnico.nombre_completo }}')" title="Eliminar">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </td>
    </tr>
    {% endfor %}
{% else %}
    <tr>
        <td colspan="8" class="empty-state">
            <i class="fas fa-user-cog"></i>
            <p>No hay técnicos registrados</p>
            <button class="btn btn-primary" onclick="openModal('createModal')">
                <i class="fas fa-plus"></i> Agregar Primer Técnico
            </button>
        </td>
    </tr>
{% endif %}
{% endblock %}

{% block form_content %}
<div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <div class="form-group">
        <label class="form-label">Número de Documento *</label>
        <input type="text" name="numero_documento" class="form-control" required placeholder="1234567890">
    </div>
    <div class="form-group">
        <label class="form-label">Tipo de Documento *</label>
        <select name="tipo_documento" class="form-control" required>
            <option value="CC">Cédula de Ciudadanía</option>
            <option value="CE">Cédula de Extranjería</option>
            <option value="PAS">Pasaporte</option>
        </select>
    </div>
</div>

<div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <div class="form-group">
        <label class="form-label">Nombres *</label>
        <input type="text" name="nombres" class="form-control" required placeholder="Nombres completos">
    </div>
    <div class="form-group">
        <label class="form-label">Apellidos *</label>
        <input type="text" name="apellidos" class="form-control" required placeholder="Apellidos">
    </div>
</div>

<div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <div class="form-group">
        <label class="form-label">Email *</label>
        <input type="email" name="email" class="form-control" required placeholder="correo@ejemplo.com">
    </div>
    <div class="form-group">
        <label class="form-label">Teléfono *</label>
        <input type="tel" name="telefono" class="form-control" required placeholder="3001234567">
    </div>
</div>

<div class="form-group">
    <label class="form-label">Dirección *</label>
    <textarea name="direccion" class="form-control" rows="2" required placeholder="Dirección completa"></textarea>
</div>

<div class="form-group">
    <label class="form-label">Especialidades *</label>
    <textarea name="especialidades" class="form-control" rows="3" required placeholder="Hardware, Software, Redes, etc."></textarea>
</div>

<div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <div class="form-group">
        <label class="form-label">Nivel de Experiencia *</label>
        <select name="nivel_experiencia" class="form-control" required>
            <option value="JUNIOR">Junior</option>
            <option value="INTERMEDIO">Intermedio</option>
            <option value="SENIOR">Senior</option>
            <option value="ESPECIALISTA">Especialista</option>
        </select>
    </div>
    <div class="form-group">
        <label class="form-label">Fecha de Ingreso *</label>
        <input type="date" name="fecha_ingreso" class="form-control" required>
    </div>
</div>

<div class="form-group">
    <label class="form-label">Certificaciones</label>
    <textarea name="certificaciones" class="form-control" rows="2" placeholder="Certificaciones obtenidas (opcional)"></textarea>
</div>

<div class="form-group">
    <label class="form-label">Salario *</label>
    <input type="number" name="salario" class="form-control" step="0.01" required placeholder="0.00">
</div>
{% endblock %}
